@import "katex/dist/katex.min.css";
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap');

/* KaTeX font-face hardening (global):
   Some deployments fail to serve KaTeX's relative font URLs, causing missing radicals (\sqrt), overlines, etc.
   We pin the fonts to stable public URLs so every symbol renders reliably. */
@font-face {
  font-display: block;
  font-family: KaTeX_AMS;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_AMS-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Caligraphic;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Caligraphic-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Caligraphic;
  font-style: normal;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_Caligraphic-Bold.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Fraktur;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Fraktur-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Fraktur;
  font-style: normal;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_Fraktur-Bold.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Main;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Main-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Main;
  font-style: italic;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Main-Italic.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Main;
  font-style: normal;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_Main-Bold.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Main;
  font-style: italic;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_Main-BoldItalic.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Math;
  font-style: italic;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Math-Italic.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Math;
  font-style: italic;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_Math-BoldItalic.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: "KaTeX_SansSerif";
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_SansSerif-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: "KaTeX_SansSerif";
  font-style: italic;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_SansSerif-Italic.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: "KaTeX_SansSerif";
  font-style: normal;
  font-weight: 700;
  src: url('/katex-fonts/KaTeX_SansSerif-Bold.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Script;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Script-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Size1;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Size1-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Size2;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Size2-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Size3;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Size3-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Size4;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Size4-Regular.woff2') format('woff2');
}
@font-face {
  font-display: block;
  font-family: KaTeX_Typewriter;
  font-style: normal;
  font-weight: 400;
  src: url('/katex-fonts/KaTeX_Typewriter-Regular.woff2') format('woff2');
}
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Woody Calculus II — Premium Futuristic Academic Theme
   Dark charcoal/near-black with neon teal/cyan accents
   Private professor workspace aesthetic
   All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Near-black base for premium feel */
    --background: 220 25% 5%;
    --foreground: 180 15% 93%;

    --card: 220 22% 7%;
    --card-foreground: 180 15% 93%;

    --popover: 220 22% 9%;
    --popover-foreground: 180 15% 93%;

    /* Neon Teal/Cyan Primary — slightly deeper */
    --primary: 175 80% 45%;
    --primary-foreground: 220 25% 5%;

    /* User message bubbles — warm subtle contrast */
    --secondary: 220 20% 18%;
    --secondary-foreground: 180 12% 88%;

    --muted: 220 18% 14%;
    --muted-foreground: 220 12% 50%;

    /* Teal accent */
    --accent: 175 65% 38%;
    --accent-foreground: 180 15% 98%;

    --destructive: 0 65% 48%;
    --destructive-foreground: 0 0% 100%;

    --border: 220 18% 16%;
    --input: 220 22% 10%;
    --ring: 175 80% 45%;

    --radius: 0.625rem;

    /* Sidebar — deeper, more refined */
    --sidebar-background: 220 28% 4%;
    --sidebar-foreground: 180 12% 80%;
    --sidebar-primary: 175 80% 45%;
    --sidebar-primary-foreground: 220 25% 5%;
    --sidebar-accent: 220 22% 10%;
    --sidebar-accent-foreground: 175 65% 55%;
    --sidebar-border: 220 20% 12%;
    --sidebar-ring: 175 80% 45%;

    /* Custom Woody tokens */
    --neon-glow: 175 80% 45%;
    --neon-subtle: 175 55% 30%;
    --surface-elevated: 220 22% 9%;
    --surface-hover: 220 20% 13%;
    --text-dim: 220 12% 40%;
    --grid-line: 220 18% 10%;
    
    /* Premium accent colors */
    --professor-gold: 45 70% 50%;
    --math-cyan: 185 75% 45%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: 'Inter', system-ui, sans-serif;
    font-feature-settings: "ss01", "ss02", "cv01";
    letter-spacing: -0.01em;
  }

  /* Custom scrollbar — more subtle */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: hsl(var(--border));
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.5);
  }
}

@layer utilities {
  /* Subtle grid texture */
  .bg-grid-texture {
    background-image: 
      linear-gradient(hsl(var(--grid-line) / 0.25) 1px, transparent 1px),
      linear-gradient(90deg, hsl(var(--grid-line) / 0.25) 1px, transparent 1px);
    background-size: 48px 48px;
  }

  /* Refined circuit texture */
  .bg-circuit-texture {
    background-image: 
      radial-gradient(ellipse at 20% 30%, hsl(var(--neon-glow) / 0.04) 0%, transparent 60%),
      radial-gradient(ellipse at 80% 70%, hsl(var(--neon-glow) / 0.02) 0%, transparent 60%);
  }

  /* Premium neon glow */
  .neon-glow {
    box-shadow: 
      0 0 4px hsl(var(--neon-glow) / 0.4),
      0 0 16px hsl(var(--neon-glow) / 0.2),
      0 0 32px hsl(var(--neon-glow) / 0.08);
  }

  .neon-glow-subtle {
    box-shadow: 
      0 0 8px hsl(var(--neon-glow) / 0.12),
      0 0 24px hsl(var(--neon-glow) / 0.06);
  }

  .neon-text-glow {
    text-shadow: 
      0 0 8px hsl(var(--neon-glow) / 0.6),
      0 0 16px hsl(var(--neon-glow) / 0.3);
  }

  .neon-border {
    border-color: hsl(var(--neon-glow) / 0.4);
    box-shadow: 
      inset 0 0 8px hsl(var(--neon-glow) / 0.08),
      0 0 8px hsl(var(--neon-glow) / 0.08);
  }

  /* Glass morphism — refined */
  .glass {
    background: hsl(var(--card) / 0.85);
    backdrop-filter: blur(16px);
    border: 1px solid hsl(var(--border) / 0.4);
  }

  /* Professional button style */
  .btn-professional {
    @apply font-medium tracking-tight;
    background: linear-gradient(180deg, hsl(var(--surface-elevated)) 0%, hsl(var(--card)) 100%);
    border: 1px solid hsl(var(--border));
    box-shadow: 
      inset 0 1px 0 hsl(var(--foreground) / 0.04),
      0 1px 2px hsl(var(--background) / 0.5);
  }

  .btn-professional:hover {
    background: linear-gradient(180deg, hsl(var(--surface-hover)) 0%, hsl(var(--surface-elevated)) 100%);
    border-color: hsl(var(--border) / 1.2);
  }
}

/* KaTeX styling — refined for dark theme */
.katex {
  font-size: 1.05em;
  color: hsl(var(--foreground));
}

.katex .base {
  color: inherit;
}

/* IMPORTANT: Tailwind's global `border-border` utility sets border-color on *every* element.
   KaTeX uses borders to draw radicals/overlines, so we must force those borders
   to follow the math color (currentColor). */
.katex,
.katex * {
  border-color: currentColor;
}

/* Some KaTeX constructs use SVG; ensure they inherit the math color too. */
.katex svg {
  fill: currentColor;
  stroke: currentColor;
}

/* Message bubble KaTeX — more refined */
.message-content .katex-display {
  margin: 0.875rem 0;
  overflow-x: auto;
  overflow-y: visible; /* allow tall glyphs like \sqrt to render */
  padding: 0.9rem 1rem; /* a bit more vertical room for radicals/overlines */
  background: hsl(var(--background) / 0.6);
  border-radius: 0.5rem;
  border: 1px solid hsl(var(--border) / 0.5);
}

.message-content .katex-display .katex {
  color: hsl(var(--math-cyan));
}
